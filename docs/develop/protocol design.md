
```text
0       1          2       3       4                             8        9       10              12               16
+-------+----------+-------+-------+-------+-------+-------+-----+--------+-------+-------+-------+---+----+---+---+
| magic | version  | flag  | codec |    request/response id      | timeout/status | header length | payload length |
+-------+----------+-------+-------+-------+-------+-------+-----+--------+-------+-------+-------+---+----+---+---+
|                                           header attachment                                                      |
|                                           payload ...                                                            |
+------------------------------------------------------------------------------------------------------------------+

version (bit) :

0       1       2       3        4        5        6        7        8
+-------+-------+-------+--------+--------+--------+--------+--------+
|                       rpc protocol version                         |
+--------------------------------------------------------------------+

flag (bit) :

0                  1         2           3          4                       8
+------------------+---------+-----------+----------+--------+----+----+----+
|  response/request/one way  | heartbeat | readonly |       unused          |
+---------------------------------------------------------------------------+

codec (bit) :

0       1       2       3        4        5        6        7        8
+-------+-------+-------+--------+--------+--------+--------+--------+
|                   serialize/deserialize id                         |
+--------------------------------------------------------------------+

```
```text
magic: 协议魔法数，固定0xAF(fast取反有效字符)。
version: rpc协议版本，固定1。
flag：rpc协议标记，0~7分别表示请求/响应、one way、心跳、readonly和保留4bit。
codec: 序列化/反序列化id。
timeout/status: 请求超时/响应状态码。
header length: 表示头部长度大小。如果compress标记非0，则代表压缩后大小。
payload length: 表示有效负载长度。
header attachment：请求或者响应头部键值对。
payload： 请求或者响应有效负载。

flag (bit)释义：
compress: 0无压缩、1xyz启用压缩, x等于0压缩header、x等于1压缩body. yz代表压缩算法id.

```